name: Daily Engineering Activity

on:
  schedule:
    # Ù‡Ø± Ø±ÙˆØ² Ø³Ø§Ø¹Øª 9 ØµØ¨Ø­ UTC (12:30 Ø¸Ù‡Ø± Ø¨Ù‡ ÙˆÙ‚Øª Ø§ÛŒØ±Ø§Ù†)
    - cron: '0 9 * * *'
  workflow_dispatch: # Ø§Ù…Ú©Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ

jobs:
  update-and-commit:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # Ø¨Ø±Ø§ÛŒ commit Ùˆ push
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0  # Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ history
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Update daily notes and files
      run: |
        python update_daily.py
    
    - name: Generate commit message
      id: commit_msg
      run: |
        # Generate diverse commit messages
        DATE=$(date +'%Y-%m-%d')
        DAY=$(date +'%A')
        
        # Random commit message style
        RAND=$((RANDOM % 10))
        
        case $RAND in
          0|1)
            MSG="ðŸ“ Update daily engineering log - $DATE"
            ;;
          2|3)
            MSG="ðŸ”§ Daily ML/AI engineering activities - $DATE"
            ;;
          4|5)
            MSG="âœ¨ Update project progress log - $DATE"
            ;;
          6)
            MSG="ðŸš€ Engineering activities update - $DATE"
            ;;
          7)
            MSG="ðŸ“Š Daily development log - $DATE"
            ;;
          8)
            MSG="âš¡ Update engineering notes - $DATE"
            ;;
          9)
            MSG="ðŸŽ¯ Daily progress update - $DATE"
            ;;
        esac
        
        echo "message=$MSG" >> $GITHUB_OUTPUT
    
    - name: Commit and push changes
      run: |
        git config --local user.email "mahdinavaei1367@gmail.com"
        git config --local user.name "Mahdi Navaei"
        
        # Add all modified files
        git add -A
        
        # Only commit if there are changes
        if ! git diff --staged --quiet; then
          git commit -m "${{ steps.commit_msg.outputs.message }}"
          git push origin main
          echo "âœ“ Changes committed and pushed successfully"
        else
          echo "â„¹ No changes to commit"
        fi
